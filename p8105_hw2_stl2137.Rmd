---
title: "p8105_HW_2"
output: github_document
---

# Homework 2 

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
library(knitr)
```

## Problem 1
### Creating Dataframe for Mr. Trash Wheel Data
```{r}
### look over, imported updated data, make sure read in data is the correct sheet

trash_wheel_df <- 
  read_excel("./data_hw_2/Trash-Wheel-Collection-Totals-8-6-19.xlsx", sheet = "Mr. Trash Wheel") %>% 
  janitor::clean_names() %>% 
  select(-c(x15, x16, x17)) %>% 
  drop_na(dumpster) %>% 
  mutate(
    sports_balls = round(pull(trash_wheel_df, sports_balls), 0) %>% 
      as.integer(pull(trash_wheel_df, sports_balls))
  )
```

### Creating Dataframe for 2018 Precipitation
```{r}
precip_2018 <- 
  read_excel("./data_hw_2/HealthyHarborWaterWheelTotals2018-7-28.xlsx", sheet = "2018 Precipitation", range = "A2:B14") %>% 
  drop_na(Total) %>% 
  mutate(
    year = 2018
  )
```

### Creating Dataframe for 2017 Precipitation
```{r}
precip_2017 <- 
  read_excel("./data_hw_2/HealthyHarborWaterWheelTotals2018-7-28.xlsx", sheet = "2017 Precipitation", range = "A2:B14") %>% 
  drop_na(Total) %>% 
  mutate(
    year = 2017
  )
```

### Combining 2017 and 2018 Precipitation Datasets
```{r}
precip_17_18 <- 
  bind_rows(precip_2017, precip_2018) %>% 
  janitor::clean_names() %>% 
  mutate(
    month = month.name[month]
  )
```

## Problem 2
### Tidying the dates 
```{r}
pols_month_df <- 
  read_csv("./data_hw_2/fivethirtyeight_datasets/pols-month.csv") %>% 
  separate(mon, c("year", "month", "day")) %>%
  mutate(
    month = as.numeric(pull(., month)),
    month = month.name[month]
    )
```

### Create president variable
```{r}
pols_month_df <- 
  pivot_longer(
    pols_month_df,
    cols = c("prez_gop", "prez_dem"),
    names_to = "president",
    names_prefix = "prez_"
  ) %>% 
  mutate(value = na_if(value, 0)) %>% 
  drop_na() %>% 
  select(-c(value, day))
```

### Cleaning snp.csv 
```{r}
snp_df <- 
  read_csv("./data_hw_2/fivethirtyeight_datasets/snp.csv") %>% 
  separate(date, c("month", "day", "year")) %>% 
  mutate(
    month = as.numeric(pull(., month)),
    month = month.name[month]
    ) %>% 
  select(year, month, close, -day) %>% 
  arrange(year, (match(month, month.name)))
```

### Cleaning Unemployment.csv
```{r}
unemploy_df <- read_csv("./data_hw_2/fivethirtyeight_datasets/unemployment.csv") %>% 
  rename(year = Year) %>% 
  mutate(
    year = as.character(year)
  )

unemploy_df <-
  pivot_longer(
    unemploy_df,
    cols = Jan:Dec,
    names_to = "month",
  ) %>% 
  mutate(
    month = match(month, month.abb),
    month = month.name[month],
  ) 
```


### Joining snp_df with pol_month_df and join_snp_pols_df with unemploy_df
```{r}
#Is this the way to do it?
join_snp_pols_df <- 
  left_join(pols_month_df, snp_df, by = c("year", "month"))

join_unemploy_df <- 
  left_join(join_snp_pols_df, unemploy_df, by = c("year", "month"))
```


## Problem 3

Issues with Baby Names Dataset:
* Year is in descending order
* Ethnicity categories are repeated with different names
* Names are both in all caps and in proper English grammer (first letter is uppercase)
```{r}
baby_names_df <- 
  read_csv("./data_hw_2/Popular_Baby_Names.csv") %>% 
  janitor::clean_names() %>% 
  distinct() %>% 
  arrange(year_of_birth) %>% 
  mutate_all(tolower) %>% 
  mutate(
    ethnicity = recode(ethnicity,
      "asian and paci" = "asian and pacific islander",
      "black non hisp" = "black non hispanic",
      "white non hisp" = "white non hispanic")
  )
```

Produce a well-structured, reader-friendly table showing the rank in popularity of the name “Olivia” as a female baby name over time; this should have rows for ethnicities and columns for year. 


```{r results = 'asis'}
Oliva_tbl <-
  baby_names_df %>% 
  select(year_of_birth, ethnicity, childs_first_name, rank) %>% 
  filter(childs_first_name == "olivia") %>% 
  pivot_wider(
    names_from = year_of_birth, 
    values_from = rank,
  ) %>%
  kable()
```

Produce a similar table showing the most popular name among male children over time.
```{r}
male_names_tbl <-
  baby_names_df %>% 
  filter(gender == "male", rank == "1") %>% 
  select(year_of_birth, ethnicity, childs_first_name, rank) %>% 
  pivot_wider(
    baby_names_df
  )
  kable()
```

